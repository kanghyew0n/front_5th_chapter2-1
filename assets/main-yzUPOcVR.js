import"./modulepreload-polyfill-B5Qt9EMX.js";const r=[{id:"p1",name:"상품1",price:1e4,quantity:50},{id:"p2",name:"상품2",price:2e4,quantity:30},{id:"p3",name:"상품3",price:3e4,quantity:20},{id:"p4",name:"상품4",price:15e3,quantity:0},{id:"p5",name:"상품5",price:25e3,quantity:10}],u=(n,{id:o,className:t,textContent:e})=>{const a=document.createElement(n);return o&&(a.id=o),t&&(a.className=t),e&&(a.textContent=e),a},I=()=>u("button",{id:"add-to-cart",className:"bg-blue-500 text-white px-4 py-2 rounded",textContent:"추가"}),q=()=>u("div",{id:"cart-items"}),b=()=>u("div",{id:"cart-total",className:"text-xl font-bold my-4"}),C=()=>u("h1",{className:"text-2xl font-bold mb-4",textContent:"장바구니"}),$=()=>u("select",{id:"product-select",className:"border rounded p-2 mr-2"}),E=()=>u("div",{id:"stock-status",className:"text-sm text-gray-500 mt-2"}),v=()=>{const n=document.getElementById("app"),o=document.createElement("div");o.className="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl p-8 mt-8";const t=[C(),q(),b(),$(),I(),E()];n.appendChild(o),t.forEach(e=>o.appendChild(e))},B=n=>{let o=document.getElementById("loyalty-points");const t=document.getElementById("cart-total"),e=Math.floor(n/1e3);if(!o){const a=u("span",{id:"loyalty-points",className:"text-blue-500 ml-2"});t.appendChild(a),o=a}o.textContent="(포인트: "+e+")"};function w(n){const o=document.getElementById("stock-status");let t="";n.forEach(function(e){e.quantity<5&&(t+=e.name+": "+(e.quantity>0?"재고 부족 ("+e.quantity+"개 남음)":"품절")+`
`)}),o.textContent=t}function g(n){const o=document.getElementById("cart-items"),t=document.getElementById("cart-total");let e=0,a=0;const s=o.children;let d=0;for(let c=0;c<s.length;c++)(function(){let l;for(let p=0;p<n.length;p++)if(n[p].id===s[c].id){l=n[p];break}const f=parseInt(s[c].querySelector("span").textContent.split("x ")[1]),h=l.price*f;let m=0;a+=f,d+=h,f>=10&&(l.id==="p1"?m=.1:l.id==="p2"?m=.15:l.id==="p3"?m=.2:l.id==="p4"?m=.05:l.id==="p5"&&(m=.25)),e+=h*(1-m)})();let i=0;if(a>=30){const c=e*.25,l=d-e;c>l?(e=d*(1-.25),i=.25):i=(d-e)/d}else i=(d-e)/d;if(new Date().getDay()===2&&(e*=1-.1,i=Math.max(i,.1)),t.textContent="총액: "+Math.round(e)+"원",i>0){const c=document.createElement("span");c.className="text-green-500 ml-2",c.textContent="("+(i*100).toFixed(1)+"% 할인 적용)",t.appendChild(c)}w(n),B(e)}function y(n){const o=document.getElementById("product-select");o===null||n===null||(o.innerHTML="",n.forEach(function(t){const e=document.createElement("option");e.value=t.id,e.textContent=t.name+" - "+t.price+"원",t.quantity===0&&(e.disabled=!0),o.appendChild(e)}))}let x;function M(){v(),y(r),g(r),setTimeout(function(){setInterval(function(){const n=r[Math.floor(Math.random()*r.length)];n||console.log(),Math.random()<.3&&n.quantity>0&&(n.price=Math.round(n.price*.8),alert("번개세일! "+n.name+"이(가) 20% 할인 중입니다!"),y(r))},3e4)},Math.random()*1e4),setTimeout(function(){setInterval(function(){if(x){const n=r.find(function(o){return o.id!==x&&o.quantity>0});n&&(alert(n.name+"은(는) 어떠세요? 지금 구매하시면 5% 추가 할인!"),n.price=Math.round(n.price*.95),y())}},6e4)},Math.random()*2e4)}M();const T=document.getElementById("add-to-cart");T.addEventListener("click",function(){const o=document.getElementById("product-select").value,t=r.find(function(e){return e.id===o});if(t&&t.quantity>0){const e=document.getElementById(t.id);if(e){const a=parseInt(e.querySelector("span").textContent.split("x ")[1])+1;a<=t.quantity?(e.querySelector("span").textContent=t.name+" - "+t.price+"원 x "+a,t.quantity--):alert("재고가 부족합니다.")}else{const a=document.createElement("div");a.id=t.id,a.className="flex justify-between items-center mb-2",a.innerHTML=`
        <span>${t.name} - ${t.price}원 x 1</span><div>
        <button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" data-change="-1">-</button>
        <button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" data-change="1">+</button>
        <button class="remove-item bg-red-500 text-white px-2 py-1 rounded" data-product-id="${t.id}">삭제</button></div>`,document.getElementById("cart-items").appendChild(a),t.quantity--}g(r),x=o}});const S=document.getElementById("cart-items");S.addEventListener("click",function(n){const o=n.target,t=o.classList.contains("quantity-change"),e=o.classList.contains("remove-item");if(t||e){const a=o.dataset.productId,s=document.getElementById(a),d=r.find(function(i){return i.id===a});if(t){const i=parseInt(o.dataset.change),c=parseInt(s.querySelector("span").textContent.split("x ")[1])+i;c>0&&c<=d.quantity+parseInt(s.querySelector("span").textContent.split("x ")[1])?(s.querySelector("span").textContent=s.querySelector("span").textContent.split("x ")[0]+"x "+c,d.quantity-=i):alert("재고가 부족합니다.")}else e&&s.remove();g(r)}});
